
pool: hosted-linux

pr: none

trigger:
  branches:
    include:
      - master
  paths:
    include:
      - src/Auth.Models
      - src/Auth.ApiConsumer
      - pipelines/Nuget.yaml


variables:
  projects: |
    Auth.Models
    Auth.ApiConsumer

stages:

  - stage: 
    displayName: Build

    jobs:

      - job: Compile
        steps:

        - task: DotNetCoreCLI@2
          inputs:
            command: pack
            configuration: release
            workingDirectory: src
            modifyOutputPath: false
            packDirectory: nugets
            packagesToPack: $(projects)
            arguments: -o nugets
            projects: $(projects)

        # - ${{ each project in variables['projects'].trim().split('\n') }}:
        #   - script: dotnet pack ${{ project }} -c release -o nugets
        #     workingDirectory: src
        #     displayName: Packing ${{ project }}

        - publish: nugets
          artifact: packed



